define(["jquery","skinConverter"],function(e,n){var r={cache:{},getImageByURL:function(n){var r=this,t=e.Deferred();0===n.indexOf("http")&&(n="/remoteimage/?url="+encodeURIComponent(n));var i=this.cache[n];if(i)return t.resolve(i),t;var a=e(new Image);return a.attr("src",n),a.load(function(){var e=a.get(0),i="data:"===n.substr(0,5);i||(r.cache[n]=e),t.resolve(e)}).error(function(e){t.reject(e)}),t},make64x64:function(r){var t=e.Deferred();return n.convert(r,function(e,n){t.resolve(n)}),t},getMinecraftSkinImage:function(e){var n="http://skins.minecraft.net/MinecraftSkins/"+e+".png";return this.getMinecraftSkinImageByURL(n)},getMinecraftSkinImageByURL:function(n){var r=this,t=e.Deferred(),i=this.getImageByURL(n),a=function(n){if(64===n.height)t.resolve(n);else{var i=r.make64x64(n);e.when(i).then(function(e){t.resolve(e)})}},c=function(e){t.reject(e)};return e.when(i).then(a,c),t}};return r});